import{a as M,r as S,Y as N,f as n,g as e,F as D,A as B,O as F,P as K,o as i,t as V,B as j,M as z,v as o,J as U,j as p,h as c,I as x,H as C,k as b,D as E,e as T,n as g,a8 as w,aa as k}from"./app-D9mk4nci.js";import{L as I,a as H,b as q}from"./lineChartData-C2kMnpEY.js";import{A as J}from"./arrayUtil-CJo8CZg1.js";import{E as O,a as A}from"./index-CF2IJHmI.js";import"./objectUtil-Z6JRxuBJ.js";import"./viewUtil-DCbZMcCo.js";import"./constants-DgoLmzql.js";import"./index-vbuHYzPE.js";import"./_baseIteratee-BHgRsBqw.js";import"./isEqual-ClA7P-IQ.js";import"./merge-DhMwWPEb.js";import"./_initCloneObject-Du8bK4lp.js";import"./isArrayLikeObject-iUnBYB8T.js";import"./index-D84rhHTp.js";const W=h=>(F("data-v-f9336731"),h=h(),K(),h),X={class:"pl-4"},Y=W(()=>e("div",{class:"mb-2"}," Server Infos: ",-1)),G={class:"flex flex-col gap-y-1"},R={class:"var-name"},Z={class:"select-all"},tt=M({__name:"MySQLBasic",props:{variableList:{}},setup(h){const s=h,t=S({}),f=[{name:"Port",value:"report_port"},{name:"Version",value:"version"},{name:"Slow Query Log",value:"slow_query_log"},{name:"Performance Schema",value:"performance_schema"},{name:"Base Directory",value:"basedir"},{name:"Data Directory",value:"datadir"}];N(()=>{t.value=J.arrayToObj(s.variableList.rows,a=>a.Variable_name,"Value")});const L=a=>t.value[a];return(a,v)=>(i(),n("div",X,[Y,e("div",G,[(i(),n(D,null,B(f,_=>e("div",{key:_.name,class:"flex gap-x-2 flex-wrap shrink-0"},[e("div",R,V(_.name)+":",1),e("div",Z,V(L(_.value)),1)])),64))])]))}}),et=j(tt,[["__scopeId","data-v-f9336731"]]),st={class:"pl-2 my-1"},at={class:"text-center"},it=M({__name:"Process",setup(h){const s=S(0),t=S({fields:[],rows:[],supportKill:!1});function f(a){return a.match(/SQL|INFO|SQL_TEXT/i)?null:a==="Host"?150:100}function L(a){o.emit("killProcess",a)}return z(()=>{o.on("processList",v=>{t.value=v}),o.emit("processList");const a=()=>{s.value=window.innerHeight-110};a(),window.addEventListener("resize",a)}),(a,v)=>{const _=U("vsc-button"),y=O,r=A;return i(),n("div",null,[e("div",st,[p(_,{type:"icon",icon:"codicon-refresh text-base",title:a.$t("common.refresh"),onClick:v[0]||(v[0]=u=>c(o).emit("processList"))},null,8,["title"])]),p(r,{data:t.value.rows,height:s.value,border:""},{default:x(()=>[(i(!0),n(D,null,B(t.value.fields,(u,l)=>(i(),C(y,{key:l,prop:u.name,label:u.name,align:"center",width:f(u.name)},null,8,["prop","label","width"]))),128)),t.value.supportKill?(i(),C(y,{key:0,label:"Action",align:"center",width:"70"},{default:x(({row:u})=>[e("div",at,[p(_,{type:"icon",icon:"codicon-debug-stop",class:"red",title:"Kill",onClick:l=>L(u)},null,8,["onClick"])])]),_:1})):b("",!0)]),_:1},8,["data","height"])])}}}),ot={class:"status-container"},lt={class:"tab"},nt={class:"flex flex-row",style:{height:"45vh","margin-top":"10px"}},rt={class:"basis-1/3"},ct={class:"basis-2/3"},ut=e("span",{class:"select-none"},"Traffic:",-1),dt={style:{height:"300px"}},pt={class:"flex"},vt={class:"basis-full"},_t=e("span",{class:"select-none"},"Queries:",-1),mt={style:{height:"300px"}},Tt=M({__name:"status",setup(h){const s=S("processList"),t=E({info:{dbType:null},process:{fields:[],rows:[]},variableList:{fields:[],rows:[]},statusList:{fields:[],rows:[]}}),f=new I,L=new I;function a(){r.dashBoard&&o.emit("dashBoard")}function v(){return window.innerHeight-80}const _=f.toChartData(),y=L.toChartData(),r=E({processList:!0,dashBoard:T(()=>["MariaDB","MySQL"].includes(t.info.dbType)),variableList:T(()=>["MariaDB","MySQL","PostgreSQL"].includes(t.info.dbType)),statusList:T(()=>["MariaDB","MySQL","PostgreSQL"].includes(t.info.dbType))});function u(){a(),o.emit("processList"),r.variableList&&o.emit("variableList"),r.statusList&&o.emit("statusList")}return o.on("info",l=>{t.info=l,r[s.value]||(s.value="processList"),u()}).on("variableList",l=>{t.variableList=l}).on("statusList",l=>{t.statusList=l}).on("dashBoard",l=>{L.addData(l.traffic),f.addData(l.queries)}).init("status"),window.addEventListener("focus",()=>{o.init("status")}),u(),setTimeout(()=>a(),1e3),setInterval(()=>a(),3e3),(l,m)=>{const Q=O,P=A;return i(),n("div",ot,[e("ul",lt,[r.dashBoard?(i(),n("li",{key:0,class:g(["tab__item",{"tab__item--active":s.value=="dashBoard"}]),onClick:m[0]||(m[0]=d=>{s.value="dashBoard",a()})}," Dashboard ",2)):b("",!0),r.processList?(i(),n("li",{key:1,class:g(["tab__item",{"tab__item--active":s.value=="processList"}]),onClick:m[1]||(m[1]=d=>{s.value="processList",c(o).emit("processList")})}," ProcessList ",2)):b("",!0),r.variableList?(i(),n("li",{key:2,class:g(["tab__item",{"tab__item--active":s.value=="variableList"}]),onClick:m[2]||(m[2]=d=>{s.value="variableList",c(o).emit("variableList")})}," VariableList ",2)):b("",!0),r.statusList?(i(),n("li",{key:3,class:g(["tab__item",{"tab__item--active":s.value=="statusList"}]),onClick:m[3]||(m[3]=d=>{s.value="statusList",c(o).emit("statusList")})}," StatusList ",2)):b("",!0)]),w(e("div",null,[e("div",nt,[e("div",rt,[p(et,{variableList:t.variableList},null,8,["variableList"])]),e("div",ct,[ut,e("div",dt,[p(c(q),{options:c(H).getOption(!0),data:c(y)},null,8,["options","data"])])])]),e("div",pt,[e("div",vt,[_t,e("div",mt,[p(c(q),{options:c(H).getOption(),data:c(_)},null,8,["options","data"])])])])],512),[[k,["MariaDB","MySQL"].includes(t.info.dbType)&&s.value=="dashBoard"]]),w(p(it,null,null,512),[[k,s.value=="processList"]]),w(e("div",null,[p(P,{data:t.variableList.rows,"cell-style":{height:"35px"},style:{width:"100%"},height:v()},{default:x(()=>[(i(!0),n(D,null,B(t.variableList.fields,(d,$)=>(i(),C(Q,{key:$,prop:d.name,label:d.name,align:"center"},null,8,["prop","label"]))),128))]),_:1},8,["data","height"])],512),[[k,t.info.dbType!="SqlServer"&&s.value=="variableList"]]),w(e("div",null,[p(P,{data:t.statusList.rows,"cell-style":{height:"35px"},style:{width:"100%"},height:v()},{default:x(()=>[(i(!0),n(D,null,B(t.statusList.fields,(d,$)=>(i(),C(Q,{key:$,prop:d.name,label:d.name,align:"center"},null,8,["prop","label"]))),128))]),_:1},8,["data","height"])],512),[[k,t.info.dbType!="SqlServer"&&s.value=="statusList"]])])}}});export{Tt as default};
